# QnA 게시판

SUNIL SHIPPING의 공통 질문 게시판입니다.

## 설치 방법

### 1. 데이터베이스 테이블 생성

`setup.sql` 파일을 실행하여 필요한 테이블을 생성합니다.

```sql
mysql -u sunilshipping -p sunilshipping < setup.sql
```

또는 phpMyAdmin에서 `setup.sql` 파일의 내용을 복사하여 실행합니다.

### 2. 파일 구조

```
qna/
├── config.php          # 데이터베이스 설정
├── index.php           # 게시판 목록
├── write.php           # 게시글 작성/수정
├── view.php            # 게시글 상세보기
├── process.php         # 처리 로직 (작성/수정/삭제/답변)
├── setup.sql           # 데이터베이스 테이블 생성 SQL
└── README.md           # 이 파일
```

## 주요 기능

### 1. 게시글 관리
- **목록 보기**: 모든 사용자가 게시글 목록을 볼 수 있습니다
- **게시글 작성**: 로그인한 사용자만 작성 가능
- **게시글 수정**: 작성자만 수정 가능
- **게시글 삭제**: 작성자 또는 관리자만 삭제 가능

### 2. 답변 기능
- 관리자만 답변 작성 가능
- 답변이 등록되면 "답변완료" 상태로 변경
- 여러 개의 답변 등록 가능

### 3. 검색 기능
- 제목, 내용, 작성자, 전체 검색 지원
- 카테고리별 분류

### 4. 카테고리
- 운송 문의 (shipping)
- 결제 문의 (payment)
- 트래킹 문의 (tracking)
- 서류 문의 (document)
- 기타 문의 (other)

## 데이터베이스 테이블

### qna 테이블
```sql
- id: 게시글 ID (자동증가)
- writer_id: 작성자 ID
- writer: 작성자 이름
- category: 카테고리
- title: 제목
- content: 내용
- email: 답변받을 이메일 (선택)
- view_count: 조회수
- status: 상태 (active/deleted)
- is_answered: 답변 여부
- created_at: 작성일
- updated_at: 수정일
```

### qna_answers 테이블
```sql
- id: 답변 ID (자동증가)
- qna_id: 게시글 ID (외래키)
- writer_id: 답변자 ID
- writer: 답변자 이름
- content: 답변 내용
- is_admin: 관리자 답변 여부
- created_at: 작성일
```

## 사용 방법

### 1. 게시판 접근
```
https://sunilshipping.mycafe24.com/qna/
```

### 2. 게시글 작성
1. 로그인 후 "글쓰기" 버튼 클릭
2. 카테고리 선택
3. 제목과 내용 입력
4. 필요시 답변받을 이메일 입력
5. "등록" 버튼 클릭

### 3. 답변 작성 (관리자)
1. 게시글 상세 페이지에서 답변 입력란에 내용 작성
2. "답변 등록" 버튼 클릭
3. 게시글이 "답변완료" 상태로 변경됨

## 권한 관리

### 일반 사용자
- 게시글 목록 조회
- 게시글 상세 조회
- 본인 게시글 작성
- 본인 게시글 수정/삭제

### 관리자 (role = 'admin')
- 모든 게시글 조회
- 답변 작성
- 모든 게시글 삭제 가능

## 페이지네이션
- 한 페이지에 15개 게시글 표시
- 페이지 번호 클릭으로 이동

## 반응형 디자인
- 데스크톱과 모바일에서 모두 최적화된 UI
- 768px 이하에서 모바일 레이아웃으로 전환

## 보안
- XSS 방지: 모든 출력 데이터 escape 처리
- SQL Injection 방지: PDO prepared statements 사용
- CSRF 방지: POST 요청 검증
- 세션 기반 인증

## 주의사항

1. **관리자 권한**: 답변 기능을 사용하려면 세션에 `role = 'admin'`이 설정되어 있어야 합니다.

2. **이메일 발송**: 현재는 이메일 발송 기능이 구현되어 있지 않습니다. 필요시 `process.php`의 `handleAnswer()` 함수에 이메일 발송 코드를 추가하세요.

3. **파일 업로드**: 현재는 텍스트만 지원합니다. 파일 첨부 기능이 필요하면 별도로 구현해야 합니다.

## 커스터마이징

### 페이지당 게시글 수 변경
`config.php` 파일에서 `ITEMS_PER_PAGE` 상수를 수정하세요.

```php
define('ITEMS_PER_PAGE', 15); // 원하는 숫자로 변경
```

### 카테고리 추가
`write.php`의 카테고리 선택 부분에 새로운 옵션을 추가하세요.

```php
<option value="new_category">새 카테고리</option>
```

## 문제 해결

### 데이터베이스 연결 실패
- `config.php`의 데이터베이스 정보를 확인하세요
- MySQL 서버가 실행 중인지 확인하세요

### 권한 오류
- 세션이 정상적으로 시작되는지 확인하세요
- 로그인 시스템이 제대로 동작하는지 확인하세요

### 페이지가 표시되지 않음
- PHP 오류 로그를 확인하세요
- 파일 권한을 확인하세요

## 라이선스
SUNIL SHIPPING 내부 사용
